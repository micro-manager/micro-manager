<project name="mmstudio" basedir="." default="jar">
	<!-- Not sure how it got the name "MMJ_", but we'd need significant
	     planning to change it -->
	<property name="product" value="MMJ_"/>

	<import file="../buildscripts/javabuild.xml"/>

	<path id="project.classpath">
		<!-- Keep alphabetical, please -->
		<pathelement location="${mm.java.lib.beanshell}"/>
		<pathelement location="${mm.java.lib.commons-math}"/>
		<pathelement location="${mm.java.lib.gson}"/>
		<pathelement location="${mm.java.lib.guava}"/>
		<pathelement location="${mm.java.lib.imagej}"/>
		<pathelement location="${mm.java.libs}/imglib2-2.0.0-beta-26.jar"/>
		<pathelement location="${mm.java.libs}/imglib2-algorithms-2.0.0-beta-26.jar"/>
		<pathelement location="${mm.java.libs}/imglib2-ij-2.0.0-beta-26.jar"/>
		<pathelement location="${mm.java.libs}/imglib2-meta-2.0.0-beta-26.jar"/>
		<pathelement location="${mm.java.libs}/imglib2-ops-2.0.0-beta-26.jar"/>
		<pathelement location="${mm.java.libs}/imglib2-realtransform-2.0.0-beta-26.jar"/>
		<pathelement location="${mm.java.lib.miglayout}"/>
		<pathelement location="${mm.java.lib.mmcorej}"/>
		<pathelement location="${mm.java.lib.rsyntaxtextarea}"/>
		<pathelement location="${mm.java.lib.scifio}"/>
	</path>

	<path id="project.linked.jars">
		<pathelement location="${mm.java.lib.imagej}"/>
		<pathelement location="${mm.java.lib.mmcorej}"/>
	</path>

	<!-- Override javabuild.xml's 'copy-files' target -->
	<property name="src.pkgroot" location="${srcdir}/org/micromanager"/>
	<property name="int.pkgroot" location="${intdir}/org/micromanager"/>
	<target name="copy-files" depends="mm.javabuild.copy-files">
        <copy todir="${int.pkgroot}/internal/icons">
            <fileset dir="${src.pkgroot}/internal/icons">
				<include name="**/*.png"/>
				<include name="**/*.gif"/>
			</fileset>
		</copy>
		<copy todir="${int.pkgroot}/internal/conf2">
			<fileset dir="${src.pkgroot}/internal/conf2" includes="*.html"/>
		</copy>
        <copy todir="${int.pkgroot}/internal/scriptpanel">
            <fileset dir="${src.pkgroot}/internal/scriptpanel" includes="*.bsh"/>
		</copy>
		<copy tofile="${intdir}/plugins.config" file="bin/plugins_mmstudio.config"/>
	</target>

	<!-- Override javabuild.xml's 'jar' target, to add manifest -->
	<target name="jar" depends="compile,copy-files">
		<mkdir dir="${outdir}"/>
		<mm-jar basedir="${intdir}" destfile="${jarfile}">
			<attribute name="Main-Class" value="org.micromanager.MMStudio"/>
		</mm-jar>
	</target>
</project>
